"use strict";function getActionOrDefault(t){return"function"==typeof t&&t||"function"==typeof t[ROUTE_ACTION]&&t[ROUTE_ACTION]||function(){}}function getRoute(t,e){var r=t[e];if(r)return{action:function(){return getActionOrDefault(r)()},route:r};var n,u=Object.keys(t).filter(function(t){return t.startsWith("/")}).find(function(t){var r=t.lastIndexOf("/"),u=t.substring(r+1),o=new RegExp(t.substring(1,r),u);return n=e.match(o)});if(n)return r=t[u],{action:function(){return getActionOrDefault(r)(n)},route:r};if(r=t["*"])return{action:function(t){return getActionOrDefault(r)(t)},route:r,stopTraversing:!0};throw new Error("404")}function traverse(t,e){var r=e[0],n=e.slice(1);if(!r||!t)return Promise.reject();var u=getRoute(t,r),o=u.action,i=u.route,a=u.stopTraversing;return Promise.resolve(o(n)).then(function(t){var e={uriSegment:r,actionResult:t};return!a&&n.length?traverse(i,n).then(function(t){return[e].concat(t)}):[e]})}function navigate(t,e,r,n){void 0===n&&(n=!0);var u="/"===t?[t]:t.split("/").map(function(t){return t||"/"});return n&&r.pushState(null,null,t),traverse(e,u).then(function(e){return{uri:t,uriSegments:e}}).catch(function(r){if("404"!==r.message)throw r;var n=e[404];return{uri:t,uriSegments:[{actionResult:n&&n()}]}})}function createRouter(t,e){void 0===t&&(t=[]),void 0===e&&(e=defaultOptions);var r=e.history;if(!r)throw new Error("History was not supplied");return{routes:t,navigate:function(e,n){return navigate(e,t,r,n)}}}Object.defineProperty(exports,"__esModule",{value:!0});var ROUTE_ACTION=Symbol("Action Route"),ROUTE_PRESETS={NUMBER:/(\d+)/,STRICT_NUMBER:/^\d+$/,KEY_VALUE_PAIRS:/([\w-]+)=([^&]*)/g,CATCH_ALL:/[\s\S]+/},defaultOptions={};exports.createRouter=createRouter,exports.ROUTE_ACTION=ROUTE_ACTION,exports.ROUTE_PRESETS=ROUTE_PRESETS;
